# Introduction

Giotto big data plaform repository.

# Getting Started
## Web app
### 1. Pull project from the repository
	git clone https://almatoolbox.visualstudio.com/Giotto/_git/giotto-platform-v.1.0.0
    git checkout develop
    cd ./hopsworks-web/yo

### 2. Install packages
```sh
	npm install -g bower@1.8.8
    npm install -g grunt-cli@1.2.0
	npm install
    bower install
```

If 'npm install' log shows this error:
```
request to http://jfrog.almaviva.it:8081/artifactory/api/npm/giotto-npm/@giotto-jfrog%2fgiotto-platform-header failed, reason: getaddrinfo ENOTFOUND jfrog.almaviva.it
```

Add this line to your /etc/hosts file (C:\Windows\System32\drivers\etc\hosts on windows):
```
10.207.127.8 jfrog.almaviva.it
```

### 3. Start dev server
You can run a local dev server using the serve task defined in Gruntfile.js:

```sh
cd hopsworks-web/yo
grunt serve --targetCustomer=CUSTOMER_NAME
```
CUSTOMER_NAME value is the name of the customer folder in app/customer_assets. When targetCustomer option isn't specified, "DEFAULT" customer name is used.
# Build and Test
## Maven build

> Use node 10.20.1. To easily switch to a node version [Node Version Manager (nvm)](https://github.com/nvm-sh/nvm#installing-and-updating) can be used.]

To build the project run the command:
```sh
mvn clean install -DskipTests -DtargetCustomer=CUSTOMER_NAME
```
CUSTOMER_NAME value is the name of the customer folder in app/customer_assets. When targetCustomer option isn't specified, "DEFAULT" customer name is used.

# Customer build configurtion

It is possible to define a build profile vy creating a folder under hopsworks-web/app/customer_assets/CUSTOMER_NAME

this folder may contain:
-- an "images" folder: all the images in this folder will be copied in the app/iamges folder, replacing any already existent images with the same name.
-- a "providers" folder: this folder can contain a customerConfig.js file. Configurations specified in this file will be injected in the MainCtrl.js controller.
-- a "styles" folder: in this folder you can define a custom.css. If you want add more css files you need to add them as <link> to the app/index.html file.

The build will output the following files that can be deployed on a Payara application server:
- hopsworks-ear/target/giotto-web.ear (backend application. Contains BE war files)
- hopsworks-web/target/giotto-web.war (frontend application)

If you want to build only the ear file:
```sh
mvn clean install -DskipTests -DtargetCustomer=CUSTOMER_NAME -DskipWebBuild
```

If you want to build only the war file:
```sh
cd hopsworks-web
mvn clean install -DskipTests -DtargetCustomer=CUSTOMER_NAME
```

## Ear/war version
If you want to know on what commit id a ear/war file was built, use the command:

```sh
jar xvf giotto-ear.ear META-INF/git.properties && cat META-INF/git.properties
```
or
```sh
jar xvf giotto-web.war META-INF/git.properties && cat META-INF/git.properties
```

This will create the META-INF directory and will extract the git.properties file from the ear/war file. Here is an example of the content:

```yml
#Generated by Git-Commit-Id-Plugin
#Mon Jun 21 11:42:38 CEST 2021
git.branch=standalone # Branch name
git.build.time=2021-06-21T11\:42\:38+0200 # Build timestamp
git.commit.id.full=e96721803daee9ed22b205bef7eba87861c831dc # Commit id
git.dirty=true # Is there any modified file at build time?
```

# Contribute

TODO: Explain how other users and developers can contribute to make your code better.

If you want to learn more about creating good readme files then refer the following [guidelines](https://www.visualstudio.com/en-us/docs/git/create-a-readme). You can also seek inspiration from the below readme files:

- [ASP.NET Core](https://github.com/aspnet/Home)
- [Visual Studio Code](https://github.com/Microsoft/vscode)
- [Chakra Core](https://github.com/Microsoft/ChakraCore)
